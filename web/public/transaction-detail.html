<blockquote>
    <p ng-bind="$ctrl.transaction.record.comment"></p>
    <footer>Entered by <b ng-bind="$ctrl.users.$getRecord($ctrl.transaction.record.by).name"></b> at {{ $ctrl.transaction.record.$priority | date:'medium' }}</footer>
</blockquote>

<ul class="list-unstyled">
    <li ng-repeat="user in $ctrl.users track by user.$id" ng-if="$ctrl.transaction.deltas[user.$id]">
        <b ng-bind="user.name"></b>
        <span ng-if="$ctrl.transaction.record.from[user.$id]">paid {{ $ctrl.transaction.record.from[user.$id]/100 | currency }}</span>
        <span ng-if="$ctrl.transaction.record.from[user.$id] && $ctrl.transaction.record.to[user.$id]">and</span>
        <span ng-if="$ctrl.transaction.record.to[user.$id]">received {{ $ctrl.transaction.record.to[user.$id] }} part{{ $ctrl.transaction.record.to[user.$id] === 1 ? '' : 's' }}</span>
        <span ng-class="'text-' + ($ctrl.transaction.deltas[user.$id] < 0 ? 'danger' : 'success')">
            <span ng-if="!$ctrl.transaction.record.reversed">({{ $ctrl.transaction.deltas[user.$id] / 100 | currency }})</span>
            <del ng-if="$ctrl.transaction.record.reversed">({{ $ctrl.transaction.deltas[user.$id] / 100 | currency }})</del>
        </span>
        <span>New total:</span>
        <span ng-class="'text-' + ($ctrl.transaction.totals[user.$id] < 0 ? 'danger' : 'success')" ng-bind="$ctrl.transaction.totals[user.$id] / 100 | currency"></span>
    </li>
</ul>

<div ng-if="!$ctrl.transaction.record.reversed">
    <button class="btn btn-danger" type="button" ng-click="$ctrl.reverse($ctrl.transaction.record.$id)">Delete</button>
</div>

<blockquote ng-if="$ctrl.transaction.record.reversed">
    <p ng-bind="$ctrl.transaction.record.reversed.comment"></p>
    <footer>Deleted by <b ng-bind="$ctrl.users.$getRecord($ctrl.transaction.record.reversed.by).name"></b> at {{ $ctrl.transaction.record.reversed.at | date:'medium' }}</footer>
</blockquote>
